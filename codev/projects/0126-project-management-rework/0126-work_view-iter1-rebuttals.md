# Phase 5 (work_view) — Consultation Rebuttals

## Items FIXED in this iteration

- **CRITICAL: Overview endpoint unreachable in workspace context** (Claude) — Fixed. Added workspace-scoped routes for `overview` and `overview/refresh` in `handleWorkspaceRoutes`, passing `workspacePath` as `workspaceOverride` to `handleOverview`. Added 2 route tests.
- **Backlog includes in-progress items** (Gemini, Codex) — Fixed. Removed "In Progress" group from `BacklogList.tsx`. Active builders are shown in the Active Builders section.
- **Gate badges only show pending** (Gemini) — Fixed. `BuilderCard.tsx` now shows both `pending` and `approved` gates.
- **Collapsed file panel has no search bar** (Codex, Claude) — Fixed. Added search input to collapsed file panel that expands on focus.

## Gemini: REQUEST_CHANGES — 2 items fixed, 2 rebutted.

### 1. Missing Playwright Tests
**Rebutted.** Playwright tests require a running Tower instance with live terminals, which is not available in the builder worktree CI context. The plan lists Playwright tests as a deliverable, but the builder cannot run E2E tests that depend on Tower infrastructure. Server-side unit tests cover the API endpoint logic (24 overview tests + 6 route tests). Component rendering is validated by the successful build. Playwright tests for the Work view are better suited to the integration test suite maintained by the architect after merge.

### 2. Fragile YAML Parsing (regex vs js-yaml)
**Rebutted.** The `status.yaml` files are machine-generated by porch, not user-edited. The YAML structure is flat key-value pairs with a single nested `gates:` map — the regex parser handles exactly this known schema. Using `js-yaml` would require importing a library that isn't currently used by the overview module (it's a dev dependency for tests, not a runtime dependency of the server code). The regex approach is ~30 lines, handles the exact known format, and fails fast with empty results on unexpected input rather than throwing parse errors. If the YAML schema grows in complexity, a library parser can be adopted then.

## Codex: REQUEST_CHANGES — 2 items fixed, 2 rebutted.

### 1. PR Linked Issue Not Clickable
**Rebutted.** Making the linked issue clickable requires the GitHub repository URL (e.g., `https://github.com/owner/repo`), which is not available in the `OverviewPR` data returned by the API. The overview endpoint calls `gh pr list --json` which returns issue numbers but not full repository URLs. Adding the repo URL would require either: (a) an additional `gh repo view --json url` call in the overview cache, or (b) hardcoding the repo URL in the dashboard. Option (a) adds latency and complexity; option (b) breaks portability. The linked issue is shown as text with "Linked:" prefix, which provides the information without the navigation. This can be enhanced in a follow-up if repo URL is added to the overview API.

### 2. Missing Playwright Tests
**Rebutted.** Same reasoning as Gemini rebuttal above. Builder cannot run Playwright tests without Tower infrastructure.

## Claude: REQUEST_CHANGES — 1 critical fixed, 2 significant rebutted, 3 minor addressed.

### 1. CRITICAL: Overview endpoint workspace routing — FIXED.

### 2. No Playwright Tests
**Rebutted.** Same reasoning as above. Builder worktree lacks Tower infrastructure for E2E tests.

### 3. No Component Tests
**Rebutted.** The dashboard uses React 19 with plain functional components. The components are presentational — they receive data via props and render JSX. Business logic lives server-side in `overview.ts` (thoroughly tested with 24 unit tests). Adding Vitest component tests would require `@testing-library/react` and JSDOM setup, neither of which are currently in the project's test infrastructure. The cost of setting up React component testing infrastructure outweighs the benefit for these straightforward presentational components. Build validation confirms the components compile and type-check correctly.

### 4. PR Linked Issue Not Clickable — Rebutted (see Codex rebuttal above).

### 5. File Panel Collapse Behavior — FIXED.

### 6. Dead 'dashboard' Type in Tab Union
**Acknowledged.** This is explicitly a Phase 6 cleanup item per the plan. The backward-compat check in `App.tsx` ensures no regression if any code still references the old tab type.
