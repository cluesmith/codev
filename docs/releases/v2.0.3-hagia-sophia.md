# v2.0.3 Hagia Sophia

Released: 2026-02-15

## Summary

Patch release with a major naming refactor (project → workspace), reliability improvements, and dead code cleanup. Total net reduction of ~4,000 lines.

## New Features

- **Spec 0108 - Porch Gate Notifications**: Push-based `af send` from porch replaces broken poll-based gate watcher. Net -80 lines. (PR #272)
- **Spec 0109 - Tunnel Keepalive**: WebSocket ping/pong heartbeat (30s ping, 10s pong timeout) detects and auto-recovers silent connection drops after sleep/wake. 10 new unit tests. (PR #271)

## Improvements

- **Spec 0112 - Workspace Rename**: All uses of "project" meaning "git repository" renamed to "workspace" across Tower, CLI, dashboard, and database. DB migration v9 renames `project_path` → `workspace_path`. +2360/-1826 across 100 files. (PR #276)
- **Spec 0111 - Dead Vanilla Dashboard Removal**: Deleted 16 dead template files from the pre-React dashboard. -4,614 lines. (PR #273)
- **Bugfix #277 - Dead Code Cleanup**: Removed codev-hq package, hq-connector, and unused utilities. -2,928 lines. (PR #278)

## Bug Fixes

- **Bugfix #266**: `codev init` and `codev adopt` now correctly copy role files from skeleton (PR #267)
- **Bugfix #269**: PrismJS, marked, and DOMPurify bundled locally to avoid CSP blocks in document viewer (PR #270)
- **Bugfix #274**: Architect terminal no longer lost on Tower restart — fixed startup race between `initInstances()` and `reconcileTerminalSessions()`, added `_reconciling` guard (PR #275)

## Documentation

- Added mobile web debugging guide (`codev/resources/mobile-web-debugging.md`)
- Added Spec 0115 draft (Consultation Metrics & Cost Tracking)

## Breaking Changes

- **DB migration v9**: Automatically renames `project_path` → `workspace_path` columns. Rollback requires manual SQL.
- **API paths changed**: `/project/` routes renamed to `/workspace/` in Tower server

## Migration Notes

Upgrade with:

```bash
npm install -g @cluesmith/codev@2.0.3
af tower stop && af tower start
```

Database migration v9 runs automatically on first Tower start. Existing terminal sessions will be preserved.
